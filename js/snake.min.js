var SNAKE=SNAKE||{};SNAKE.addEventListener=function(){if(window.addEventListener)return function(l,f,c,k){l.addEventListener(f,c,k)};if(window.attachEvent)return function(l,f,c){l.attachEvent("on"+f,c)}}();SNAKE.removeEventListener=function(){if(window.removeEventListener)return function(l,f,c,k){l.removeEventListener(f,c,k)};if(window.detachEvent)return function(l,f,c){l.detachEvent("on"+f,c)}}();
SNAKE.Snake=SNAKE.Snake||function(){var l=0,f=[],c=function(){this.elmStyle=this.elm=null;this.col=this.row=-1;this.yPos=this.xPos=-1E3;this.prev=this.next=null};return function(k){function u(){var a=document.createElement("div");a.className="snake-snakebody-block";a.style.left="-1000px";a.style.top="-1000px";a.style.width=e.getBlockWidth()+"px";a.style.height=e.getBlockHeight()+"px";return a}function p(a){for(var b,d=u(),m=1;m<a;m++)b=new c,b.elm=d.cloneNode(!0),b.elmStyle=b.elm.style,e.getBoardContainer().appendChild(b.elm),
f[f.length]=b;b=new c;b.elm=d;e.getBoardContainer().appendChild(b.elm);f[f.length]=b}if(k&&k.playingBoard){var a=this,e=k.playingBoard;l++;var d=[],w=1,g=[0,1,0,-1],x=[-1,0,1,0],q=[],r=[],t=75,v=!1,h=!1;t=75;a.snakeBody={};a.snakeBody.b0=new c;a.snakeBody.b0.row=k.startRow||1;a.snakeBody.b0.col=k.startCol||1;a.snakeBody.b0.xPos=a.snakeBody.b0.row*e.getBlockWidth();a.snakeBody.b0.yPos=a.snakeBody.b0.col*e.getBlockHeight();a.snakeBody.b0.elm=u();a.snakeBody.b0.elmStyle=a.snakeBody.b0.elm.style;e.getBoardContainer().appendChild(a.snakeBody.b0.elm);
a.snakeBody.b0.elm.style.left=a.snakeBody.b0.xPos+"px";a.snakeBody.b0.elm.style.top=a.snakeBody.b0.yPos+"px";a.snakeBody.b0.next=a.snakeBody.b0;a.snakeBody.b0.prev=a.snakeBody.b0;a.snakeLength=1;a.snakeHead=a.snakeBody.b0;a.snakeTail=a.snakeBody.b0;a.snakeHead.elm.className=a.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,"");a.snakeHead.elm.className+=" snake-snakebody-alive";a.setPaused=function(a){h=a};a.getPaused=function(){return h};a.handleArrowKeys=function(m){if(!v&&!h){var b=
a.snakeLength,n=d[0]||w;switch(m){case 37:case 65:1===n&&1!==b||d.unshift(3);break;case 38:case 87:2===n&&1!==b||d.unshift(0);break;case 39:case 68:3===n&&1!==b||d.unshift(1);break;case 40:case 83:0===n&&1!==b||d.unshift(2)}}};a.go=function(){var m=a.snakeHead,b=a.snakeTail,n=w,c=e.grid;!0===h?setTimeout(function(){a.go()},t):(a.snakeTail=b.prev,a.snakeHead=b,c[b.row]&&c[b.row][b.col]&&(c[b.row][b.col]=0),d.length&&(n=w=d.pop()),b.col=m.col+g[n],b.row=m.row+x[n],b.xPos=m.xPos+q[n],b.yPos=m.yPos+r[n],
b.elmStyle||(b.elmStyle=b.elm.style),b.elmStyle.left=b.xPos+"px",b.elmStyle.top=b.yPos+"px",0===c[b.row][b.col]?(c[b.row][b.col]=1,setTimeout(function(){a.go()},t)):0<c[b.row][b.col]?a.handleDeath():c[b.row][b.col]===e.getGridFoodValue()&&(c[b.row][b.col]=1,a.eatFood(),setTimeout(function(){a.go()},t)))};a.eatFood=function(){5>=f.length&&p(10);for(var d=f.splice(0,5),b=d.length,c,g=a.snakeTail;b--;)c="b"+a.snakeLength++,a.snakeBody[c]=d[b],a.snakeBody[c].prev=g,a.snakeBody[c].elm.className=a.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,
""),a.snakeBody[c].elm.className+=" snake-snakebody-alive",g.next=a.snakeBody[c],g=a.snakeBody[c];a.snakeTail=a.snakeBody[c];a.snakeTail.next=a.snakeHead;a.snakeHead.prev=a.snakeTail;e.foodEaten()};a.handleDeath=function(){var c=localStorage.jsSnakeHighScore;void 0==c&&localStorage.setItem("jsSnakeHighScore",a.snakeLength);a.snakeLength>c&&(alert("Congratulations! You have beaten your previous high score, which was "+c+"."),localStorage.setItem("jsSnakeHighScore",a.snakeLength));c=a.snakeHead.elm.style;
var b=a.snakeBody,g=0,h=0,f;for(f in b)b[f].elm.currentStyle?h=parseFloat(b[f].elm.style["z-index"],10):window.getComputedStyle&&(h=parseFloat(document.defaultView.getComputedStyle(b[f].elm,null).getPropertyValue("z-index"),10)),!isNaN(h)&&h>g&&(g=h);c.zIndex=g+1;a.snakeHead.elm.className=a.snakeHead.elm.className.replace(/\bsnake-snakebody-alive\b/,"");a.snakeHead.elm.className+=" snake-snakebody-dead";v=!0;e.handleDeath();d.length=0};a.rebirth=function(){v=!1};a.reset=function(){if(!1!==v){for(var d=
[],b=a.snakeHead.next,c;b!==a.snakeHead;)c=b.next,b.prev=null,b.next=null,d.push(b),b=c;a.snakeHead.next=a.snakeHead;a.snakeHead.prev=a.snakeHead;a.snakeTail=a.snakeHead;a.snakeLength=1;for(b=0;b<d.length;b++)d[b].elm.style.left="-1000px",d[b].elm.style.top="-1000px",d[b].elm.className=a.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),d[b].elm.className+=" snake-snakebody-alive";f.concat(d);a.snakeHead.elm.className=a.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,"");a.snakeHead.elm.className+=
" snake-snakebody-alive";a.snakeHead.row=k.startRow||1;a.snakeHead.col=k.startCol||1;a.snakeHead.xPos=a.snakeHead.row*e.getBlockWidth();a.snakeHead.yPos=a.snakeHead.col*e.getBlockHeight();a.snakeHead.elm.style.left=a.snakeHead.xPos+"px";a.snakeHead.elm.style.top=a.snakeHead.yPos+"px"}};p(10);q[0]=0;q[1]=e.getBlockWidth();q[2]=0;q[3]=-1*e.getBlockWidth();r[0]=-1*e.getBlockHeight();r[1]=0;r[2]=e.getBlockHeight();r[3]=0}}}();
SNAKE.Food=SNAKE.Food||function(){var l=0;return function(f){if(f&&f.playingBoard){var c=f.playingBoard,k,u;f=l++;var p=document.createElement("div");p.setAttribute("id","snake-food-"+f);p.className="snake-food-block";p.style.width=c.getBlockWidth()+"px";p.style.height=c.getBlockHeight()+"px";p.style.left="-1000px";p.style.top="-1000px";c.getBoardContainer().appendChild(p);this.getFoodElement=function(){return p};this.randomlyPlaceFood=function(){c.grid[k]&&c.grid[k][u]===c.getGridFoodValue()&&(c.grid[k][u]=
0);for(var a=0,e=0,d=0,f=c.grid.length-1,g=c.grid[0].length-1;0!==c.grid[a][e];)if(a=Math.floor(Math.random()*(f+1-1))+1,e=Math.floor(Math.random()*(g+1-1))+1,d++,2E4<d){e=a=-1;break}c.grid[a][e]=c.getGridFoodValue();k=a;u=e;p.style.top=a*c.getBlockHeight()+"px";p.style.left=e*c.getBlockWidth()+"px"}}}}();
SNAKE.Board=SNAKE.Board||function(){function l(c){var f=0,a=0,e;for(e in c)c[e].elm.currentStyle?a=parseFloat(c[e].elm.style["z-index"],10):window.getComputedStyle&&(a=parseFloat(document.defaultView.getComputedStyle(c[e].elm,null).getPropertyValue("z-index"),10)),!isNaN(a)&&a>f&&(f=a);return f+1}function f(){var c=0;"number"===typeof window.innerWidth?c=window.innerWidth:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?c=document.documentElement.clientWidth:
document.body&&(document.body.clientWidth||document.body.clientHeight)&&(c=document.body.clientWidth);return c}function c(){var c=0;"number"===typeof window.innerHeight?c=window.innerHeight:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?c=document.documentElement.clientHeight:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(c=document.body.clientHeight);return c}var k=0;return function(u){function p(){m=document.createElement("div");
m.setAttribute("id","playingField");m.className="snake-playing-field";SNAKE.addEventListener(m,"click",function(){h.focus()},!1);z=document.createElement("div");z.className="snake-pause-screen";z.innerHTML="<div style='padding:10px;'>[Paused]<p/>Press [space] to unpause.</div>";b=document.createElement("div");b.className="snake-panel-component";b.innerHTML="<a href='http://patorjk.com/blog/software/' class='snake-link'>more patorjk.com apps</a> - <a href='https://github.com/patorjk/JavaScript-Snake' class='snake-link'>source code</a>";
n=document.createElement("div");n.className="snake-panel-component";n.innerHTML="Length: 1";A=a();y=e();SNAKE.addEventListener(h,"keyup",function(a){a||(a=window.event);a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1},!1);h.className="snake-game-container";z.style.zIndex=1E4;h.appendChild(z);h.appendChild(m);h.appendChild(n);h.appendChild(A);h.appendChild(y);q=new SNAKE.Snake({playingBoard:d,startRow:2,startCol:2});x=new SNAKE.Food({playingBoard:d});
A.style.zIndex=1E3}function a(){var a=document.createElement("div");a.id="sbWelcome"+w;a.className="snake-welcome-dialog";var b=document.createElement("div"),c="";g.fullScreen&&(c="On Windows, press F11 to play in Full Screen mode.");b.innerHTML="JavaScript Snake<p></p>Use the <strong>arrow keys</strong> on your keyboard to play the game. "+c+"<p></p>";c=document.createElement("button");c.appendChild(document.createTextNode("Play Game"));var f=function(){SNAKE.removeEventListener(window,"keyup",h,
!1);a.style.display="none";d.setBoardState(1);d.getBoardContainer().focus()},h=function(a){a||(a=window.event);a=a.which?a.which:a.keyCode;32!==a&&13!==a||f()};SNAKE.addEventListener(window,"keyup",h,!1);SNAKE.addEventListener(c,"click",f,!1);a.appendChild(b);a.appendChild(c);return a}function e(){var a=document.createElement("div");a.id="sbTryAgain"+w;a.className="snake-try-again-dialog";var c=document.createElement("div");c.innerHTML="JavaScript Snake<p></p>You died :(.<p></p>";var b=document.createElement("button");
b.appendChild(document.createTextNode("Play Again?"));var f=function(){a.style.display="none";d.resetBoard();d.setBoardState(1);d.getBoardContainer().focus()};SNAKE.addEventListener(window,"keyup",function(b){0===r&&"block"===a.style.display&&(b||(b=window.event),b=b.which?b.which:b.keyCode,32!==b&&13!==b||f())},!0);SNAKE.addEventListener(b,"click",f,!1);a.appendChild(c);a.appendChild(b);return a}var d=this,w=k++,g=u||{},x,q,r=1,t,v=!1,h,m,b,n,A,y,z;d.grid=[];d.setPaused=function(a){v=a;q.setPaused(a);
z.style.display=v?"block":"none"};d.getPaused=function(){return v};d.resetBoard=function(){SNAKE.removeEventListener(h,"keydown",t,!1);q.reset();n.innerHTML="Length: 1";d.setupPlayingField()};d.getBoardState=function(){return r};d.setBoardState=function(a){r=a};d.getGridFoodValue=function(){return-1};d.getPlayingFieldElement=function(){return m};d.setBoardContainer=function(a){"string"===typeof a&&(a=document.getElementById(a));a!==h&&(h=a,m=null,d.setupPlayingField())};d.getBoardContainer=function(){return h};
d.getBlockWidth=function(){return 20};d.getBlockHeight=function(){return 20};d.setupPlayingField=function(){m||p();if(!0===g.fullScreen){cLeft=cTop=0;var a=f()-5;var e=c()-5;document.body.style.backgroundColor="#000000"}else cTop=g.top,cLeft=g.left,a=g.width,e=g.height;var k=2*d.getBlockWidth()+a%d.getBlockWidth(),l=Math.min(250*d.getBlockWidth()-k,a-k),r=3*d.getBlockHeight()+e%d.getBlockHeight();k=Math.min(250*d.getBlockHeight()-r,e-r);h.style.left=cLeft+"px";h.style.top=cTop+"px";h.style.width=
a+"px";h.style.height=e+"px";m.style.left=d.getBlockWidth()+"px";m.style.top=d.getBlockHeight()+"px";m.style.width=l+"px";m.style.height=k+"px";e=r-d.getBlockHeight();e=d.getBlockHeight()+k+Math.round((e-30)/2)+"px";b.style.top=e;b.style.width="450px";b.style.left=Math.round(a/2)-225+"px";n.style.top=e;n.style.left=a-120+"px";b.style.display=700>a?"none":"block";d.grid=[];a=l/d.getBlockWidth()+2;k=k/d.getBlockHeight()+2;for(l=0;l<k;l++)for(d.grid[l]=[],e=0;e<a;e++)d.grid[l][e]=0===e||0===l||e===a-
1||l===k-1?1:0;x.randomlyPlaceFood();snakeSpeed=75;t=function(a){a||(a=window.event);var b=a.which?a.which:a.keyCode;if(1===d.getBoardState()){if(!(37<=b&&40>=b)&&87!==b&&65!==b&&83!==b&&68!==b)return;SNAKE.removeEventListener(h,"keydown",t,!1);t=function(a){a||(a=window.event);var b=a.which?a.which:a.keyCode;32===b&&0!=d.getBoardState()&&d.setPaused(!d.getPaused());q.handleArrowKeys(b);a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1};SNAKE.addEventListener(h,
"keydown",t,!1);q.rebirth();q.handleArrowKeys(b);d.setBoardState(2);q.go()}a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1};SNAKE.addEventListener(h,"keydown",t,!1)};d.foodEaten=function(){n.innerHTML="Length: "+q.snakeLength;x.randomlyPlaceFood()};d.handleDeath=function(){var a=Math.max(l(q.snakeBody),l({tmp:{elm:x.getFoodElement()}}));h.removeChild(y);h.appendChild(y);y.style.zIndex=a;y.style.display="block";d.setBoardState(0)};g.fullScreen=
"undefined"===typeof g.fullScreen?!1:g.fullScreen;g.top="undefined"===typeof g.top?0:g.top;g.left="undefined"===typeof g.left?0:g.left;g.width="undefined"===typeof g.width?400:g.width;g.height="undefined"===typeof g.height?400:g.height;g.fullScreen&&SNAKE.addEventListener(window,"resize",function(){d.setupPlayingField()},!1);d.setBoardState(0);g.boardContainer&&d.setBoardContainer(g.boardContainer)}}();
function getHighScore(){document.getElementById("high-score").addEventListener("click",function(){void 0==localStorage.jsSnakeHighScore?alert("You have not played this game yet!"):alert("Your current high score is "+localStorage.jsSnakeHighScore+".")})};
